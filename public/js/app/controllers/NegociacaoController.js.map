{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_$data","_$quantidade","_$valor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacaoService","_ordenacao","_init","listaCadastradas","then","adicionaTodas","negociacoes","catch","texto","error","event","preventDefault","negociacao","_criaNegociacao","cadastra","adiciona","mensagem","limpaCampos","apagaTodas","esvazia","value","focus","importa","coluna","inverteOrdem","ordena","a","b","dataStr","data","DateHelper","textoParaData","quantidade","valor","Negociacao"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\r\n\r\n\tconstructor() {\r\n\t\tlet $ = document.querySelector.bind(document)\r\n\r\n\t\tthis._$data = $('#data')\r\n\t\tthis._$quantidade = $('#quantidade')\r\n\t\tthis._$valor = $('#valor')\r\n\r\n\t\t/* there's no need to save views as attributes since\r\n\t\twe are using one way data binding - model changes updates view */\r\n\t\tthis._listaNegociacoes = new Bind(\r\n\t\t\tnew ListaNegociacoes() // this model\r\n\t\t\t, new NegociacoesView($('#negociacoes_view')) // updates this view\r\n\t\t\t, 'adiciona', 'esvazia', 'ordena', 'inverteOrdem' // when this properties change\r\n\t\t)\r\n\r\n\t\tthis._mensagem = new Bind(\r\n\t\t\tnew Mensagem()\r\n\t\t\t, new MensagemView($('#mensagem_view'))\r\n\t\t\t, 'texto'\r\n\t\t)\r\n\r\n\t\tthis._service = new NegociacaoService()\r\n\t\tthis._ordenacao = '' // field of Negociacao order listaNegociacoes\r\n\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_init() {\r\n\t\tthis._service.listaCadastradas()\r\n\t\t\t.then(negociacoes => this._listaNegociacoes.adicionaTodas(negociacoes))\r\n\t\t\t.catch(error => this._mensagem.texto = error)\r\n\t}\r\n\r\n\tadiciona(event) {\r\n\t\tevent.preventDefault()\r\n\r\n\t\tlet negociacao = this._criaNegociacao()\r\n\r\n\t\tthis._service.cadastra(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\r\n\t\t\t\tthis._mensagem.texto = mensagem\r\n\t\t\t\tthis.limpaCampos()\r\n\t\t\t})\r\n\t\t\t.catch(error => this._mensagem.texto = error)\r\n\t}\r\n\r\n\tapagaTudo() {\r\n\t\tthis._service.apagaTodas()\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.esvazia()\r\n\t\t\t\tthis._mensagem.texto = mensagem\r\n\t\t\t})\r\n\t\t\t.catch(error => this._mensagem.texto = error)\r\n\t}\r\n\r\n\t/* setting default values for each element */\r\n\tlimpaCampos() {\r\n\t\tthis._$data.value = \"\"\r\n\t\tthis._$quantidade.value = 1\r\n\t\tthis._$valor.value = 0\r\n\t\tthis._$data.focus()\r\n\t}\r\n\r\n\timportaNegociacoes() {\r\n\t\tthis._service.importa(this._listaNegociacoes.negociacoes)\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tthis._listaNegociacoes.adicionaTodas(negociacoes)\r\n\t\t\t\tthis._mensagem.texto = 'As negociações da semana foram importadas.';\r\n\t\t\t})\r\n\t\t\t.catch(error => this._mensagem.texto = error)\r\n\t}\r\n\r\n\tordena(coluna) {\r\n\t\tif(this._ordenacao === coluna)\r\n\t\t\tthis._listaNegociacoes.inverteOrdem()\r\n\t\telse {\r\n\t\t\tthis._ordenacao = coluna\r\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\t}\r\n\r\n\t/* retrieving form data */\r\n\t_criaNegociacao() {\r\n\t\tlet dataStr = this._$data.value;\r\n\t\tlet data = DateHelper.textoParaData(dataStr)\r\n\t\tlet quantidade = this._$quantidade.value\r\n\t\tlet valor = this._$valor.value\r\n\t\treturn new Negociacao(data, quantidade, valor)\r\n\t}\r\n\r\n}\r\n"]}